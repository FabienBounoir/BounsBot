import { useState, useEffect } from "react"
import "./_info.css";
import guildsApi from "../../utils/API/guildsAPI"

export const Info = (props) => {
    const [bestGuilds, setBestGuilds] = useState(null)

    useEffect(() => {
        async function fetchData() {
            await Promise.all([
                getInfo()
            ])
        }
        fetchData()
    }, [props.guildId])

    let getInfo = async () => {
        let guilds = await guildsApi.best()
        setBestGuilds(guilds)
    }

    //arrondir a la centaine au dessus
    let formatNumber = (number) => {
        if (number > 1000) {
            return Math.ceil(number / 100) * 100
        }
        else if (number > 100) {
            return Math.ceil(number / 10) * 10
        }
        else {
            return number
        }
    }


    let renderGuilds = (max, display = false) => {
        return bestGuilds?.guilds.slice(0, max)?.map((guild, index) => {
            return (<div className="guilds">
                {/* style="--play: running; --direction: normal; --duration: 76.8s; --delay: 0s; --iteration-count: infinite;"> */}
                <img src={guild.iconURL || "https://media.discordapp.net/attachments/1014101467126304798/1056241554764869673/image.png?width=1290&height=1290"} alt="logo" onError={(e) => { e.target.outerHTML = `<img loading="lazy" src='https://media.discordapp.net/attachments/1014101467126304798/1056241554764869673/image.png?width=1290&height=1290'/>` }} />
                <div>
                    <h3>{guild.name}</h3>

                    <div className="member">

                        <svg width="18" viewBox="0 0 60 61" fill="none" xmlns="http:www.w3.org/2000/svg">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M35 20.4977C35 26.0103 30.515 30.4978 25 30.4978C19.4875 30.4978 15 26.0103 15 20.4977C15 14.9852 19.485 10.4977 25 10.4977C30.515 10.4977 35 14.9852 35 20.4977ZM5.00003 47.9978C5.00003 39.1653 13.225 32.9978 25 32.9978C36.7775 32.9978 45 39.1653 45 47.9978V50.4978H5.00003V47.9978Z" fill="#D9D9D9" />
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M35 20.4977C35 26.0103 30.515 30.4978 25 30.4978C19.4875 30.4978 15 26.0103 15 20.4977C15 14.9852 19.485 10.4977 25 10.4977C30.515 10.4977 35 14.9852 35 20.4977ZM5.00003 47.9978C5.00003 39.1653 13.225 32.9978 25 32.9978C36.7775 32.9978 45 39.1653 45 47.9978V50.4978H5.00003V47.9978Z" fill="#D9D9D9" />
                            <path d="M50.0003 50.498H55.0003V47.998C55.0003 41.5913 50.6743 36.5868 43.8033 34.321C47.6553 37.7648 50.0003 42.4978 50.0003 47.998V50.498Z" fill="#D9D9D9" />
                            <path d="M37.2084 30.252C41.6642 29.2437 45.0002 25.252 45.0002 20.4977C45.0002 15.4056 41.1732 11.1882 36.2427 10.5745C38.5804 13.2205 40.0002 16.6958 40.0002 20.4977C40.0002 24.1049 38.7222 27.4182 36.5944 30.0082C36.8007 30.0872 37.0054 30.1685 37.2084 30.252Z" fill="#D9D9D9" />
                        </svg>
                        <p>{formatNumber(guild.memberCount)} {display ? "membres" : ""}</p>
                    </div>
                </div>
            </div>)
        })
    }

    return (bestGuilds ? (
        <div className="infoComponent">
            <h2>Bounsbot, le bot Discord approuvÃ© par plus de {formatNumber(bestGuilds?.totalGuild)} serveurs</h2>
            <div className="guilds-container desktop">
                {(() => {
                    return renderGuilds(8);
                })()}
            </div>
            <div className="guilds-container tablette">
                {(() => {
                    return renderGuilds(6);
                })()}
            </div>

            <div className="guilds-container mobile">
                {(() => {
                    return renderGuilds(4, true);
                })()}
            </div>

            <svg width="180" height="144" className="clydeLove" viewBox="0 0 273 219" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M252.001 125.402C251.711 125.436 251.418 125.412 251.138 125.331C250.858 125.251 250.597 125.115 250.37 124.932C250.143 124.749 249.954 124.523 249.816 124.267C249.677 124.01 249.591 123.729 249.562 123.439C249.5 122.876 249.662 122.311 250.013 121.866L263.708 102.232C263.859 101.985 264.057 101.771 264.292 101.602C264.526 101.433 264.791 101.312 265.073 101.246C265.354 101.18 265.645 101.171 265.93 101.219C266.215 101.267 266.488 101.37 266.733 101.524L266.879 101.622C267.356 101.984 267.674 102.517 267.765 103.108C267.856 103.7 267.713 104.304 267.367 104.793L253.83 124.427C253.612 124.71 253.336 124.943 253.02 125.111C252.705 125.279 252.357 125.379 252.001 125.402Z" fill="black" />
                <path d="M252 125.402C251.479 125.365 250.976 125.197 250.537 124.915C250.147 124.602 249.874 124.167 249.763 123.68C249.652 123.192 249.71 122.682 249.927 122.232C252.146 116.871 252.319 110.883 250.415 105.402C250.192 104.899 250.178 104.328 250.374 103.814C250.571 103.3 250.962 102.885 251.464 102.658L251.635 102.598C251.899 102.482 252.183 102.42 252.471 102.415C252.76 102.409 253.046 102.461 253.315 102.566C253.583 102.671 253.828 102.828 254.036 103.028C254.243 103.228 254.409 103.467 254.525 103.732V103.817C256.175 108.342 256.595 113.223 255.744 117.963C264.159 113.451 270.378 113.817 270.622 113.939C270.895 113.936 271.166 113.987 271.419 114.089C271.671 114.191 271.901 114.342 272.095 114.534C272.289 114.726 272.443 114.954 272.549 115.206C272.654 115.457 272.708 115.727 272.708 116C272.714 116.085 272.714 116.171 272.708 116.256C272.711 116.529 272.66 116.799 272.558 117.052C272.456 117.305 272.304 117.535 272.113 117.729C271.921 117.923 271.693 118.077 271.441 118.182C271.189 118.287 270.919 118.341 270.647 118.341H270.391C270.269 118.341 262.708 117.976 253.317 124.927C252.94 125.221 252.479 125.388 252 125.402Z" fill="black" />
                <path d="M159.439 195.219C156.375 195.25 153.414 194.115 151.156 192.043C148.898 189.972 147.512 187.119 147.279 184.064C147.046 181.008 147.984 177.978 149.903 175.589C151.821 173.199 154.576 171.628 157.61 171.195C208.464 163.146 210.659 159.976 238.708 122.171C239.546 120.825 240.641 119.657 241.931 118.734C243.221 117.811 244.679 117.152 246.224 116.793C247.769 116.434 249.369 116.383 250.933 116.642C252.498 116.901 253.996 117.466 255.342 118.305C256.688 119.143 257.855 120.239 258.778 121.528C259.701 122.818 260.361 124.277 260.72 125.821C261.079 127.366 261.13 128.966 260.87 130.531C260.611 132.095 260.046 133.593 259.208 134.939C258.873 135.464 258.503 135.966 258.098 136.439C227.732 177.659 220.049 185.707 161.39 194.976L159.439 195.219Z" fill="url(#paint0_linear_615_2)" />
                <path d="M218.219 148.024L215.902 150.585L230.902 169.366L233.463 167.049L218.219 148.024Z" fill="#51B1FC" />
                <path d="M196.757 162.658L193.586 163.756L200.781 186.561L204.074 185.463L196.757 162.658Z" fill="#51B1FC" />
                <path d="M174.074 192.902L177.366 192.293L173.708 168.39L170.415 169L174.074 192.902Z" fill="#51B1FC" />
                <path d="M232.122 130.951L230.171 133.634L249.073 148.573L251.146 145.89L232.122 130.951Z" fill="#51B1FC" />
                <path d="M198.708 36.6828C196.871 30.5499 193.348 25.0568 188.539 20.8304C183.731 16.604 177.831 13.8146 171.513 12.7804C123.766 4.89095 74.748 12.6329 31.7567 34.8536C26.04 37.7615 21.2578 42.2208 17.9579 47.7206C14.658 53.2204 12.9738 59.5385 13.0982 65.9511C13.5367 87.1564 16.8598 108.203 22.9762 128.512C24.8541 134.632 28.4084 140.103 33.2365 144.306C38.0646 148.509 43.9734 151.276 50.2934 152.293C98.0267 160.297 147.068 152.594 190.049 130.341C195.766 127.401 200.544 122.917 203.842 117.399C207.139 111.881 208.825 105.549 208.708 99.1219C208.438 88.5449 207.501 77.9955 205.903 67.5365C204.234 57.0955 201.829 46.7853 198.708 36.6828Z" fill="url(#paint1_linear_615_2)" />
                <path d="M188.341 43.5122C187.135 39.19 184.713 35.3056 181.361 32.3219C178.01 29.3381 173.871 27.3807 169.439 26.6829C153.103 24.3428 136.492 24.755 120.292 27.9024C103.894 31.1834 88.1523 37.1586 73.707 45.5853C69.7472 47.9265 66.4911 51.2909 64.2808 55.3253C62.0705 59.3596 60.9877 63.9148 61.146 68.5122C61.4038 76.1874 62.096 83.8419 63.2192 91.439C64.4361 98.9821 66.1471 106.437 68.3412 113.756C69.5323 118.053 71.9378 121.914 75.269 124.878C78.6002 127.841 82.7156 129.781 87.1216 130.463C103.494 132.865 120.156 132.452 136.39 129.244C152.736 125.979 168.434 120.046 182.853 111.683C186.845 109.337 190.131 105.958 192.363 101.902C194.595 97.8453 195.692 93.2616 195.536 88.6341C195.293 80.9933 194.56 73.376 193.341 65.8292C192.17 58.2878 190.5 50.8324 188.341 43.5122Z" fill="var(--color-principal-hover)" />
                <path d="M184.561 47.5366C183.348 43.2151 180.944 39.3222 177.623 36.3029C174.301 33.2837 170.198 31.26 165.78 30.4634C149.439 27.9153 132.786 28.1214 116.512 31.0731C99.9692 34.1948 84.0609 40.047 69.4389 48.3902C65.4099 50.7253 62.0975 54.1195 59.8616 58.2044C57.6257 62.2893 56.5516 66.9087 56.756 71.561C56.9786 79.3701 57.7528 87.1537 59.073 94.8536C60.2828 102.489 62.0353 110.028 64.317 117.415C65.5366 121.784 67.9922 125.708 71.3888 128.715C74.7854 131.723 78.9782 133.685 83.4633 134.366C99.9169 136.773 116.66 136.361 132.976 133.146C149.296 129.925 164.96 123.989 179.317 115.585C183.231 113.243 186.44 109.888 188.608 105.875C190.776 101.862 191.821 97.3379 191.634 92.7805C191.493 85.0984 190.8 77.4364 189.561 69.8536C188.327 62.3241 186.658 54.8726 184.561 47.5366Z" fill="black" />
                <path d="M33.5126 131.73C42.6982 128.834 46.4339 114.718 41.8568 100.201C37.2796 85.6838 26.1227 76.2632 16.9371 79.1594C7.75159 82.0556 4.01573 96.1718 8.59292 110.689C13.1701 125.206 24.3271 134.626 33.5126 131.73Z" fill="var(--color-principal)" />
                <path d="M61.1464 22.1707C71.8781 18.878 80.0488 15.5853 91.0245 18.756C96.1464 20.3414 101.025 21.1951 124.073 17.2926C137.122 14.9756 135.903 10.8292 135.171 6.56093C133.951 -0.0244397 120.659 -2.09762 88.9513 3.63409C57.244 9.36579 61.1464 22.1707 61.1464 22.1707Z" fill="url(#paint2_linear_615_2)" />
                <path d="M183.464 218.39H56.1465L62.122 199.488L69.1953 177.049C69.7302 175.341 70.4671 173.704 71.3904 172.171C73.2424 169.421 75.7518 167.178 78.6908 165.645C81.6297 164.111 84.9052 163.336 88.2196 163.39L154.927 165.097C159.166 165.152 163.268 166.604 166.597 169.228C169.927 171.852 172.298 175.501 173.342 179.61L183.464 218.39Z" fill="var(--color-principal)" />
                <path d="M171.268 218.39H125.415C124.927 214.732 124.195 210.219 123.341 204.366C121.878 194.244 120.537 182.658 117 174.488C116.901 174.266 116.846 174.027 116.84 173.784C116.833 173.541 116.875 173.299 116.962 173.073C117.049 172.846 117.18 172.639 117.348 172.463C117.516 172.287 117.717 172.146 117.939 172.049C118.219 171.927 118.525 171.877 118.829 171.902L156.39 172.634C157.31 172.652 158.206 172.923 158.981 173.418C159.755 173.913 160.378 174.612 160.781 175.439C165.659 184.61 167.976 199.244 171.268 218.39Z" fill="var(--color-principal-hover)" />
                <path d="M83.4641 195.098C74.8056 195.829 67.7324 197.171 62.1227 199.488C57.4072 201.141 53.2327 204.051 50.0495 207.902C47.8091 211.048 46.2324 214.616 45.4154 218.39H20.7812C21.9154 209.279 25.404 200.621 30.9032 193.268C39.5617 182.049 52.8544 175.098 71.391 172.171C74.643 171.683 78.0576 171.317 81.6349 171.073C83.2122 170.832 84.8218 170.905 86.3706 171.289C87.9194 171.674 89.3765 172.361 90.6579 173.312C91.9394 174.263 93.0195 175.459 93.836 176.83C94.6525 178.201 95.1891 179.72 95.4147 181.3C95.6404 182.879 95.5507 184.488 95.1508 186.033C94.7509 187.578 94.0486 189.028 93.0848 190.3C92.1209 191.571 90.9145 192.639 89.5353 193.442C88.1561 194.245 86.6315 194.766 85.0496 194.976C84.5245 195.053 83.9948 195.093 83.4641 195.098Z" fill="url(#paint3_linear_615_2)" />
                <path d="M153.586 57.4146C144.073 51.0731 131.147 53.3902 124.927 62.6585C115.415 56.317 102.854 58.7561 97.1223 67.7805C91.3905 76.8048 94.8052 88.2683 104.073 94L136.634 114.244L158.586 84.6097C165.049 75.9512 162.854 63.7561 153.586 57.4146Z" fill="var(--color-principal)" />
                <path d="M35.5368 188.024L33.2197 190.585L50.1709 207.78L52.488 205.219L35.5368 188.024Z" fill="#3F99F2" />
                <path d="M64.3171 173.634L61.0244 174.366L67.8537 197.536L71.1464 196.805L64.3171 173.634Z" fill="#3F99F2" />
                <defs>
                    <linearGradient id="paint0_linear_615_2" x1="190.866" y1="172.122" x2="245.366" y2="128.915" gradientUnits="userSpaceOnUse">
                        <stop stop-color="#66BCFF" />
                        <stop offset="1" stop-color="#8CD9FF" />
                    </linearGradient>
                    <linearGradient id="paint1_linear_615_2" x1="100.964" y1="0.963318" x2="120.184" y2="159.049" gradientUnits="userSpaceOnUse">
                        <stop stop-color="var(--color-principal-hover)" />
                        <stop offset="1" stop-color="var(--color-principal)" />
                    </linearGradient>
                    <linearGradient id="paint2_linear_615_2" x1="61.1586" y1="11.2317" x2="135.598" y2="11.2317" gradientUnits="userSpaceOnUse">
                        <stop stop-color="#66BCFF" />
                        <stop offset="1" stop-color="#8CD9FF" />
                    </linearGradient>
                    <linearGradient id="paint3_linear_615_2" x1="58.0983" y1="168.476" x2="58.0983" y2="214.671" gradientUnits="userSpaceOnUse">
                        <stop stop-color="#66BCFF" />
                        <stop offset="1" stop-color="#51B1FC" />
                    </linearGradient>
                </defs>

            </svg>

        </div>) : (null))
}



